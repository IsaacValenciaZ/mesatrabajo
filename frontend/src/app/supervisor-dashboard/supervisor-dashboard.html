<div class="gob-bar">
  <div class="logos-container">
    <img src="icons/seiem_blanco.svg" class="SEIEM" alt="Logo SEIEM">
  </div>
</div>

<div class="dashboard-container">

  <header class="header">
    <div class="header-content">
      <h1>PANEL DE SUPERVISIÓN</h1>
      <p>Resumen de usuarios registrados en el sistema.</p>
    </div>
    <div class="header-actions">

      <button class="btn-create" (click)="openCreateModal()">+ Crear Usuario</button>
      @if (showCreate) {
      <div class="modal-overlay">
        <app-create-user (close)="closeModals()" (create)="handleCreateUser($event)"></app-create-user>
      </div>
      }
      <button class="btn-logout" (click)="logout()">Cerrar Sesión</button>
    </div>
  </header>

  <div class="stats-grid">
    <div class="card stat-card personal">
      <span class="stat-label">PERSONAL</span>
      <span class="stat-number">{{ countPersonal }}</span>
      <div class="indicator"></div>
    </div>

    <div class="card stat-card supervisor">
      <span class="stat-label">SUPERVISORES</span>
      <span class="stat-number">{{ countSupervisor }}</span>
      <div class="indicator"></div>
    </div>

    <div class="card stat-card admin">
      <span class="stat-label">ADMINISTRADORES</span>
      <span class="stat-number">{{ countAdmin }}</span>
      <div class="indicator"></div>
    </div>

    <div class="card stat-card total">
      <span class="stat-label">USUARIOS TOTALES</span>
      <span class="stat-number">{{ totalUsers }}</span>
    </div>
  </div>

  <div class="card table-card">
    <div class="card-header">
      <h2>Listado Completo</h2>
    </div>

    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>NOMBRE</th>
            <th>CORREO ELECTRONICO</th>
            <th>ROL</th>
            <th>CAMBIOS</th>
          </tr>
        </thead>
        <tbody>
          @for (user of usersList; track user.id) {
          <tr>
            <td class="name-cell">
              <div class="avatar-circle">{{ user.nombre.charAt(0) }}</div>
              {{ user.nombre }}
            </td>
            <td class="email-cell">{{ user.email }}</td>
            <td>
              <span class="badge" [class.badge-personal]="user.rol === 'personal' || user.rol === 'Personal'"
                [class.badge-supervisor]="user.rol === 'supervisor' || user.rol === 'Supervisor'"
                [class.badge-admin]="user.rol === 'admin' || user.rol === 'Admin'">
                {{ user.rol }}

              </span>

            </td>

            <td class="actions-cell">
              <div class="actions-buttons">

                <button class="btn-action view" (click)="openViewModal(user)">Ver</button>
                @if (showView) {
                <div class="modal-overlay">
                  <app-view-user [user]="selectedUser" (close)="closeModals()"></app-view-user>
                </div>
                }

                <button class="btn-action edit" (click)="openEditModal(user)">Editar</button>
                @if (showEdit) {
                <div class="modal-overlay">
                  <app-edit-user [user]="selectedUser" (close)="closeModals()"></app-edit-user>
                </div>
                }

                <button class="btn-action delete" (click)="openDeleteModal(user)">Eliminar</button>
                @if (showDelete) {
                <div class="modal-overlay">
                  <app-delete-user [user]="selectedUser" (close)="closeModals()"></app-delete-user>
                </div>
                }
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>